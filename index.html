<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenST投影仓库</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="favicon.png">
</head>
<body>
<div class="header-bg"></div>
<img src="favicon.png" alt="OpenST" class="logo">
<h1 class="title">OpenST投影仓库</h1>
<header class="header">
    <a href="https://github.com/MC-OpenST/storage-schematic-archive-2.0" target="_blank" id="github-c">本站Github</a>
    <a href="https://qun.qq.com/universal-share/share?ac=1&authKey=f3%2BtcY1W8cwr5FnVHqYRjcmpCnMHmzhWl20X3Rfz7JmEyRA2q%2FsyBNGJAvULW1W5&busi_data=eyJncm91cENvZGUiOiI0NDAxMzg5MTYiLCJ0b2tlbiI6IkxCN2pKcGRvb3FjWFpiUDgrVEQya0dVVU9PUHFwVFBMcER4anJNM2dnRTNSNVQwaTUxY0UxTllob25raHpGY20iLCJ1aW4iOiIzODI5MTU2NzE2In0%3D&data=hHLh0imxWvsAqo6bxLAOLaWG5G6St164fHq81TATtYRw3wLxNkQKxlm81M7c8gG3FfjjJZaC6CThT0EPDtJjEw&svctype=4&tempid=h5_group_info" id="qq-c">QQ群</a>
    <a href="https://discord.gg/6MSCN6JanU" target="_blank" id="discord-c">Discord 分馆</a>
</header>

<div id="controls">
  <input type="text" id="search-input" placeholder="搜索文件...">
  <div id="tag-list"></div>
</div>

<div id="file-list"></div>
<div style="height: 200px;"></div>

<script src="scripts/main.js" type="module"></script>
<script src="scripts/lazyload.js" type="module"></script>
<script type="module">
    import { initLazyLoad } from './scripts/lazyload.js';

    async function loadFiles() {
        const res = await fetch('https://openst.weizhihan3.workers.dev/list');
        const files = await res.json();

        const container = document.getElementById('file-list');
        container.innerHTML = '';

        files.forEach(file => {
            if (file.name.endsWith('.png')) return;

            const item = document.createElement('div');
            item.className = 'file-item';

            const img = document.createElement('img');
            img.dataset.src = `https://openst.weizhihan3.workers.dev/${file.preview}`;
            img.width = 300;
            img.height = 200;

            item.appendChild(img);
            container.appendChild(item);
        });

        // DOM 渲染后再挂懒加载
        initLazyLoad({ container });
    }

    // 等 DOM 就绪后再启动
    document.addEventListener("DOMContentLoaded", () => {
        loadFiles();
    });
</script>
</body>
</html>


